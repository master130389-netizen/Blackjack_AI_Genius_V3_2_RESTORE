name: Controllo automatico del progetto
run: |
  echo "Eseguo il controllo locale automatizzato..."
  python3 full_project_check.py || true

- name: Invia notifica Telegram con report
  env:
    TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
    TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
  run: |
    echo "Invio report Telegram..."
    pip install requests
    REPORT=$(cat report.txt)
    python3 <<EOF
    import os, requests
    token = os.environ["TELEGRAM_TOKEN"]
    chat = os.environ["TELEGRAM_CHAT_ID"]
    msg = f"### Risultati controllo progetto Blackjack AI Genius V3\n\n{REPORT}"
    requests.post(f"https://api.telegram.org/bot{token}/sendMessage", data={"chat_id": chat, "text": msg})
    EOF
